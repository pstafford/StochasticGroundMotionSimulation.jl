


# function to implement the Boore & Thompson (2014) excitation duration function
function boore_thompson_2014(m::T, r::T, fas::FourierParameters) where T<:Float64
  # source duration
  fa, fb, ε = corner_frequency(m, fas)
  if fas.source.source_model == :Atkinson_Silva_2000
    Ds = 0.5 / fa + 0.5 / fb
  else
    Ds = 1.0 / fa
  end
  # path duration
  if r == 0.0
    return Ds
  elseif r > 0.0 && r <= 7.0
    return Ds + r / 7.0 * 2.4
  elseif r > 7.0 && r <= 45.0
    return Ds + 2.4 + (r - 7.0)/(45.0 - 7.0)*(8.4 - 2.4)
  elseif r > 45.0 && r <= 125.0
    return Ds + 8.4 + (r - 45.0)/(125.0 - 45.0)*(10.9 - 8.4)
  elseif r > 125.0 && r <= 175.0
    return Ds + 10.9 + (r - 125.0)/(175.0 - 125.0)*(17.4 - 10.9)
  elseif r > 175.0 && r <= 270.0
    return Ds + 17.4 + (r - 175.0)/(270.0 - 175.0)*(34.2 - 17.4)
  elseif r > 270.0
    return Ds + 34.2 + 0.156 * (r - 270.0)
  end
end



# Definition of Boore & Thompson (2012) constant values to be used within subsequent functions
const m_ii_bt12 = [ 4.0, 4.5, 5.0, 5.5, 6.0, 6.5, 7.0, 7.5, 8.0 ]
const r_jj_bt12 = [ 2.00, 3.17, 5.02, 7.96, 12.62, 20.00, 31.70, 50.24, 79.62, 126.19, 200.00, 317.00, 502.40, 796.20, 1262.00 ]
const num_r_jj_bt12 = 15

const coefs_wna_bt12 = [ 4.0    2.00  8.4312e-01 -2.8671e-02 2.0  1.7316e+00  1.1695e+00  2.1671e+00  9.6224e-01  9.9929e-01  9.4336e-01   4.0    2.00; 4.5    2.00  8.3064e-01 -5.3355e-08 2.0  1.6962e+00  1.3236e+00  2.0308e+00  9.5517e-01  1.0176e+00  9.6580e-01   4.5    2.00; 5.0    2.00  8.9701e-01 -1.0484e-02 2.0  1.7181e+00  1.2797e+00  1.9295e+00  1.0163e+00  1.0290e+00  9.6175e-01   5.0    2.00; 5.5    2.00  8.3574e-01 -1.2031e-06 2.0  1.3859e+00  1.2015e+00  1.9904e+00  8.1829e-01  1.0523e+00  9.8336e-01   5.5    2.00; 6.0    2.00  8.4485e-01 -1.2609e-02 2.0  1.2391e+00  9.9399e-01  2.0532e+00  7.4884e-01  1.0681e+00  9.7567e-01   6.0    2.00; 6.5    2.00  8.4348e-01 -1.4520e-06 2.0  1.1331e+00  9.3441e-01  2.0328e+00  7.1150e-01  1.0680e+00  9.7535e-01   6.5    2.00; 7.0    2.00  8.0078e-01 -1.0231e-03 2.0  9.9676e-01  8.0084e-01  2.1466e+00  5.9286e-01  1.0908e+00  9.7381e-01   7.0    2.00; 7.5    2.00  8.3352e-01 -2.0697e-03 2.0  9.4601e-01  8.2133e-01  2.1052e+00  6.1011e-01  1.0849e+00  9.5386e-01   7.5    2.00; 8.0    2.00  1.1818e+00 -3.7875e-01 2.0  7.6114e-01  2.4868e+00  3.4051e+00  5.1616e-01  1.1002e+00  9.3188e-01   8.0    2.00; 4.0    3.17  8.2110e-01 -4.7357e-03 2.0  1.8627e+00  1.6118e+00  2.0128e+00  9.6557e-01  1.0024e+00  9.6134e-01   4.0    3.17; 4.5    3.17  8.7601e-01 -5.9903e-07 2.0  1.8200e+00  1.4626e+00  1.9542e+00  1.0076e+00  1.0074e+00  9.5429e-01   4.5    3.17; 5.0    3.17  8.3971e-01 -3.0439e-03 2.0  1.5964e+00  1.3635e+00  1.9761e+00  8.9640e-01  1.0425e+00  9.7057e-01   5.0    3.17; 5.5    3.17  8.3455e-01 -2.8341e-06 2.0  1.3116e+00  1.1068e+00  2.0414e+00  7.7989e-01  1.0458e+00  9.8125e-01   5.5    3.17; 6.0    3.17  8.1645e-01 -8.3202e-08 2.0  1.1908e+00  9.8968e-01  2.0549e+00  6.9953e-01  1.0647e+00  9.7531e-01   6.0    3.17; 6.5    3.17  8.2440e-01 -2.2922e-19 2.0  1.1212e+00  9.2690e-01  2.0537e+00  6.7673e-01  1.0722e+00  9.7217e-01   6.5    3.17; 7.0    3.17  8.3242e-01 -4.0859e-03 2.0  1.0919e+00  1.0439e+00  2.0355e+00  6.6335e-01  1.0850e+00  9.6470e-01   7.0    3.17; 7.5    3.17  8.3241e-01 -8.3435e-03 2.0  1.1067e+00  1.1521e+00  1.9907e+00  6.4715e-01  1.0951e+00  9.4210e-01   7.5    3.17; 8.0    3.17  8.3994e-01 -2.6168e-02 2.0  9.6494e-01  9.0967e-01  2.2436e+00  5.8696e-01  1.1028e+00  9.2279e-01   8.0    3.17; 4.0    5.02  8.6329e-01 -4.0771e-02 2.0  1.8792e+00  1.7825e+00  2.0071e+00  9.5979e-01  1.0150e+00  9.6497e-01   4.0    5.02; 4.5    5.02  8.4825e-01 -5.8380e-05 2.0  1.8285e+00  1.6611e+00  1.9249e+00  9.6711e-01  1.0252e+00  9.7713e-01   4.5    5.02; 5.0    5.02  8.4446e-01 -3.4661e-22 2.0  1.5463e+00  1.4665e+00  1.9448e+00  8.6771e-01  1.0329e+00  9.7563e-01   5.0    5.02; 5.5    5.02  8.4978e-01 -6.2734e-09 2.0  1.5126e+00  1.4004e+00  1.9072e+00  8.4997e-01  1.0460e+00  9.7378e-01   5.5    5.02; 6.0    5.02  8.2129e-01 -4.5730e-06 2.0  1.2115e+00  1.0578e+00  2.0028e+00  7.0987e-01  1.0598e+00  9.7654e-01   6.0    5.02; 6.5    5.02  8.1544e-01 -1.9160e-08 2.0  1.0668e+00  8.4143e-01  2.0735e+00  6.5158e-01  1.0751e+00  9.7467e-01   6.5    5.02; 7.0    5.02  8.2414e-01 -4.0369e-03 2.0  1.0467e+00  7.1242e-01  2.1586e+00  6.2836e-01  1.0794e+00  9.5870e-01   7.0    5.02; 7.5    5.02  8.9473e-01 -5.3853e-02 2.0  1.0888e+00  1.4138e+00  2.0212e+00  6.7776e-01  1.0900e+00  9.5025e-01   7.5    5.02; 8.0    5.02  9.2147e-01 -8.9899e-02 2.0  9.5008e-01  1.1607e+00  2.4017e+00  6.2635e-01  1.0980e+00  9.2819e-01   8.0    5.02; 4.0    7.96  8.4779e-01 -2.8493e-02 2.0  2.0858e+00  2.6221e+00  1.8501e+00  9.5690e-01  1.0194e+00  9.7959e-01   4.0    7.96; 4.5    7.96  8.4677e-01 -2.1554e-14 2.0  1.9701e+00  2.2219e+00  1.7755e+00  9.8498e-01  1.0316e+00  9.9715e-01   4.5    7.96; 5.0    7.96  8.8283e-01 -4.1263e-07 2.0  1.9400e+00  1.8389e+00  1.8013e+00  1.0235e+00  1.0334e+00  9.7377e-01   5.0    7.96; 5.5    7.96  8.2785e-01 -8.1587e-17 2.0  1.4890e+00  1.4475e+00  1.9052e+00  8.1571e-01  1.0561e+00  9.8353e-01   5.5    7.96; 6.0    7.96  8.3393e-01 -4.2583e-08 2.0  1.4016e+00  1.4232e+00  1.8975e+00  7.8526e-01  1.0658e+00  9.7835e-01   6.0    7.96; 6.5    7.96  8.1429e-01 -2.8150e-05 2.0  1.0955e+00  9.3363e-01  2.0547e+00  6.6504e-01  1.0786e+00  9.8445e-01   6.5    7.96; 7.0    7.96  8.0350e-01 -3.1805e-06 2.0  1.0903e+00  1.0120e+00  2.0825e+00  6.3175e-01  1.0930e+00  9.6779e-01   7.0    7.96; 7.5    7.96  8.6455e-01 -4.9497e-02 2.0  1.0672e+00  1.3965e+00  2.0600e+00  6.2719e-01  1.0924e+00  9.5518e-01   7.5    7.96; 8.0    7.96  9.3068e-01 -1.0354e-01 2.0  1.0295e+00  1.7393e+00  2.1326e+00  6.3596e-01  1.0994e+00  9.2609e-01   8.0    7.96; 4.0   12.62  8.4343e-01 -9.4015e-03 2.0  1.7138e+00  2.7357e+00  1.8332e+00  8.7570e-01  1.0193e+00  9.9529e-01   4.0   12.62; 4.5   12.62  8.2603e-01 -1.5203e-02 2.0  1.7515e+00  2.3023e+00  1.8093e+00  8.6816e-01  1.0462e+00  9.9553e-01   4.5   12.62; 5.0   12.62  8.5078e-01 -6.8471e-17 2.0  1.6943e+00  1.8025e+00  1.7993e+00  9.1795e-01  1.0461e+00  1.0026e+00   5.0   12.62; 5.5   12.62  8.4406e-01 -4.2873e-07 2.0  1.6936e+00  1.6701e+00  1.7942e+00  8.9001e-01  1.0584e+00  9.8314e-01   5.5   12.62; 6.0   12.62  8.1873e-01 -9.7554e-08 2.0  1.3379e+00  1.3058e+00  1.9370e+00  7.4590e-01  1.0649e+00  9.8476e-01   6.0   12.62; 6.5   12.62  8.2130e-01 -1.1179e-06 2.0  1.0666e+00  9.5527e-01  2.0441e+00  6.5972e-01  1.0706e+00  9.9066e-01   6.5   12.62; 7.0   12.62  8.3901e-01 -3.8867e-03 2.0  1.0721e+00  9.7602e-01  2.0319e+00  6.7214e-01  1.0773e+00  9.7088e-01   7.0   12.62; 7.5   12.62  8.8154e-01 -5.3242e-02 2.0  1.0746e+00  1.4629e+00  2.0001e+00  6.4928e-01  1.0882e+00  9.4526e-01   7.5   12.62; 8.0   12.62  9.6254e-01 -1.5468e-01 2.0  8.4972e-01  1.1369e+00  2.6445e+00  5.5070e-01  1.0967e+00  9.2600e-01   8.0   12.62; 4.0   20.00  8.4020e-01 -4.0622e-03 2.0  1.7122e+00  3.7111e+00  1.7781e+00  8.3369e-01  1.0231e+00  1.0055e+00   4.0   20.00; 4.5   20.00  8.0074e-01 -1.1163e-03 2.0  1.6050e+00  2.5984e+00  1.7981e+00  8.0776e-01  1.0514e+00  1.0107e+00   4.5   20.00; 5.0   20.00  8.1957e-01 -2.6783e-08 2.0  1.5537e+00  1.9525e+00  1.8541e+00  8.1185e-01  1.0503e+00  9.9790e-01   5.0   20.00; 5.5   20.00  8.4597e-01 -2.1761e-28 2.0  1.6384e+00  1.8613e+00  1.7709e+00  8.6430e-01  1.0543e+00  9.8634e-01   5.5   20.00; 6.0   20.00  8.1936e-01 -2.8792e-08 2.0  1.2967e+00  1.3933e+00  1.9226e+00  7.3484e-01  1.0646e+00  9.9737e-01   6.0   20.00; 6.5   20.00  8.2149e-01 -2.1626e-07 2.0  1.2651e+00  1.1833e+00  1.8904e+00  7.2337e-01  1.0798e+00  9.7962e-01   6.5   20.00; 7.0   20.00  8.2885e-01 -1.4510e-02 2.0  1.0514e+00  8.6325e-01  2.0854e+00  6.3459e-01  1.0858e+00  9.7187e-01   7.0   20.00; 7.5   20.00  8.8599e-01 -6.7109e-02 2.0  1.0820e+00  1.4223e+00  2.1483e+00  6.5140e-01  1.0931e+00  9.5410e-01   7.5   20.00; 8.0   20.00  9.6561e-01 -1.5069e-01 2.0  9.2494e-01  1.6108e+00  2.3995e+00  5.7877e-01  1.0942e+00  9.3791e-01   8.0   20.00; 4.0   31.70  8.1172e-01 -4.8496e-04 2.0  1.5154e+00  4.2066e+00  1.7868e+00  7.5495e-01  1.0411e+00  1.0121e+00   4.0   31.70; 4.5   31.70  7.8971e-01 -1.1171e-07 2.0  1.3881e+00  2.8525e+00  1.9129e+00  7.1011e-01  1.0446e+00  1.0101e+00   4.5   31.70; 5.0   31.70  7.8907e-01 -3.0999e-07 2.0  1.3945e+00  1.9681e+00  1.8882e+00  7.2307e-01  1.0590e+00  1.0093e+00   5.0   31.70; 5.5   31.70  8.2863e-01 -4.3712e-29 2.0  1.5918e+00  1.8609e+00  1.7700e+00  8.3632e-01  1.0636e+00  1.0051e+00   5.5   31.70; 6.0   31.70  8.1063e-01 -2.5156e-07 2.0  1.3122e+00  1.4358e+00  1.8632e+00  7.3257e-01  1.0734e+00  1.0013e+00   6.0   31.70; 6.5   31.70  8.1517e-01 -5.7539e-06 2.0  1.1768e+00  1.1135e+00  1.8888e+00  6.9805e-01  1.0796e+00  9.8922e-01   6.5   31.70; 7.0   31.70  8.1577e-01 -1.2460e-04 2.0  1.1862e+00  1.0549e+00  1.9416e+00  6.8195e-01  1.0868e+00  9.6233e-01   7.0   31.70; 7.5   31.70  9.2526e-01 -1.1605e-01 2.0  1.0984e+00  1.6537e+00  2.1768e+00  6.4739e-01  1.0974e+00  9.5360e-01   7.5   31.70; 8.0   31.70  9.0070e-01 -1.0408e-01 2.0  9.3630e-01  1.4596e+00  2.2897e+00  5.6532e-01  1.0993e+00  9.3947e-01   8.0   31.70; 4.0   50.24  7.4376e-01 -9.0204e-03 2.0  1.1760e+00  5.3724e+00  1.9952e+00  5.7376e-01  1.0611e+00  1.0292e+00   4.0   50.24; 4.5   50.24  7.6692e-01 -2.8995e-07 2.0  1.2262e+00  3.1344e+00  1.9104e+00  6.3632e-01  1.0607e+00  1.0303e+00   4.5   50.24; 5.0   50.24  8.0410e-01 -1.7249e-07 2.0  1.2658e+00  2.0493e+00  1.8728e+00  7.1205e-01  1.0610e+00  1.0300e+00   5.0   50.24; 5.5   50.24  8.0289e-01 -7.3756e-10 2.0  1.3033e+00  1.9082e+00  1.8283e+00  7.1257e-01  1.0611e+00  1.0228e+00   5.5   50.24; 6.0   50.24  8.2058e-01 -3.3962e-07 2.0  1.4215e+00  1.7148e+00  1.7918e+00  7.7238e-01  1.0701e+00  9.9697e-01   6.0   50.24; 6.5   50.24  8.1998e-01 -3.7615e-08 2.0  1.3171e+00  1.5287e+00  1.8113e+00  7.3336e-01  1.0743e+00  9.8469e-01   6.5   50.24; 7.0   50.24  8.0401e-01 -1.8401e-03 2.0  1.2092e+00  1.1668e+00  1.9378e+00  6.7879e-01  1.0950e+00  9.7028e-01   7.0   50.24; 7.5   50.24  9.2124e-01 -1.1109e-01 2.0  1.0821e+00  1.7469e+00  2.2082e+00  6.4069e-01  1.0886e+00  9.5945e-01   7.5   50.24; 8.0   50.24  9.1213e-01 -1.0459e-01 2.0  1.0303e+00  1.7188e+00  2.1460e+00  6.1959e-01  1.0951e+00  9.3272e-01   8.0   50.24; 4.0   79.62  7.1877e-01 -8.4424e-07 2.0  9.8189e-01  5.7882e+00  1.9315e+00  4.8869e-01  1.0633e+00  1.0405e+00   4.0   79.62; 4.5   79.62  7.6806e-01 -7.7865e-10 2.0  1.1500e+00  4.2410e+00  1.8852e+00  5.8860e-01  1.0545e+00  1.0258e+00   4.5   79.62; 5.0   79.62  8.1221e-01 -1.9339e-06 2.0  1.3867e+00  3.2310e+00  1.7712e+00  7.2172e-01  1.0557e+00  1.0225e+00   5.0   79.62; 5.5   79.62  8.1179e-01 -3.6814e-15 2.0  1.3673e+00  2.3510e+00  1.7695e+00  7.3065e-01  1.0617e+00  1.0209e+00   5.5   79.62; 6.0   79.62  8.3805e-01 -3.9863e-07 2.0  1.4750e+00  1.7874e+00  1.7191e+00  8.0489e-01  1.0630e+00  1.0006e+00   6.0   79.62; 6.5   79.62  8.3461e-01 -3.2932e-04 2.0  1.5359e+00  1.6907e+00  1.7029e+00  8.1570e-01  1.0730e+00  9.7817e-01   6.5   79.62; 7.0   79.62  8.2516e-01 -1.0574e-03 2.0  1.4617e+00  1.6598e+00  1.7075e+00  7.8372e-01  1.0840e+00  9.7763e-01   7.0   79.62; 7.5   79.62  9.2678e-01 -1.2826e-01 2.0  1.0954e+00  1.8061e+00  2.2617e+00  6.3883e-01  1.0935e+00  9.5951e-01   7.5   79.62; 8.0   79.62  9.4781e-01 -1.3027e-01 2.0  1.1123e+00  1.9835e+00  2.2682e+00  6.5983e-01  1.0897e+00  9.3568e-01   8.0   79.62; 4.0  126.19  7.0065e-01 -3.0866e-03 2.0  7.7514e-01  4.3880e+00  2.1942e+00  3.9751e-01  1.0665e+00  1.0430e+00   4.0  126.19; 4.5  126.19  7.3944e-01 -6.1421e-03 2.0  8.4700e-01  3.1720e+00  2.1861e+00  4.6495e-01  1.0631e+00  1.0421e+00   4.5  126.19; 5.0  126.19  8.0513e-01 -3.1300e-07 2.0  1.4173e+00  3.7696e+00  1.7451e+00  7.2746e-01  1.0661e+00  1.0375e+00   5.0  126.19; 5.5  126.19  8.3644e-01 -1.2787e-02 2.0  1.6253e+00  3.0751e+00  1.6687e+00  8.0811e-01  1.0660e+00  1.0188e+00   5.5  126.19; 6.0  126.19  8.4568e-01 -1.0589e-02 2.0  1.6317e+00  2.5450e+00  1.6207e+00  8.3600e-01  1.0663e+00  1.0196e+00   6.0  126.19; 6.5  126.19  8.4142e-01 -9.2432e-03 2.0  1.6367e+00  2.2281e+00  1.6330e+00  8.4571e-01  1.0759e+00  1.0072e+00   6.5  126.19; 7.0  126.19  8.3694e-01 -1.8592e-12 2.0  1.4260e+00  1.8587e+00  1.6980e+00  7.8752e-01  1.0719e+00  9.9019e-01   7.0  126.19; 7.5  126.19  9.7787e-01 -1.5087e-01 2.0  1.3198e+00  2.7095e+00  2.0948e+00  7.4851e-01  1.0802e+00  9.6889e-01   7.5  126.19; 8.0  126.19  9.5551e-01 -1.3687e-01 2.0  1.0502e+00  1.6420e+00  2.2945e+00  6.6223e-01  1.0834e+00  9.5884e-01   8.0  126.19; 4.0  200.00  7.2408e-01 -3.7872e-06 2.0  7.9315e-01  3.3863e+00  2.1194e+00  4.3168e-01  1.0731e+00  1.0494e+00   4.0  200.00; 4.5  200.00  7.6883e-01 -1.0649e-10 2.0  8.4489e-01  3.0451e+00  2.0022e+00  5.1530e-01  1.0674e+00  1.0491e+00   4.5  200.00; 5.0  200.00  8.0446e-01 -1.1419e-07 2.0  1.2079e+00  3.5405e+00  1.7311e+00  6.7846e-01  1.0708e+00  1.0434e+00   5.0  200.00; 5.5  200.00  8.5125e-01 -2.0805e-02 2.0  1.6828e+00  3.7940e+00  1.5949e+00  8.1298e-01  1.0634e+00  1.0157e+00   5.5  200.00; 6.0  200.00  8.8936e-01 -3.4678e-02 2.0  1.9176e+00  3.6113e+00  1.5457e+00  9.0903e-01  1.0583e+00  1.0253e+00   6.0  200.00; 6.5  200.00  8.8360e-01 -4.3347e-02 2.0  2.1189e+00  3.0810e+00  1.5627e+00  9.3733e-01  1.0723e+00  1.0070e+00   6.5  200.00; 7.0  200.00  8.8401e-01 -4.3273e-02 2.0  2.2411e+00  3.1543e+00  1.5785e+00  9.5961e-01  1.0768e+00  9.8898e-01   7.0  200.00; 7.5  200.00  9.7709e-01 -1.3800e-01 2.0  1.3833e+00  2.6413e+00  2.0144e+00  7.8650e-01  1.0724e+00  9.7395e-01   7.5  200.00; 8.0  200.00  9.4766e-01 -1.2599e-01 2.0  1.0937e+00  1.7927e+00  2.1485e+00  6.8255e-01  1.0817e+00  9.6134e-01   8.0  200.00; 4.0  317.00  7.3621e-01 -2.6124e-07 2.0  6.7866e-01  1.5442e+00  2.3208e+00  4.0993e-01  1.0759e+00  1.0570e+00   4.0  317.00; 4.5  317.00  7.7046e-01 -2.0803e-06 2.0  8.4695e-01  2.4074e+00  1.9286e+00  5.2494e-01  1.0786e+00  1.0462e+00   4.5  317.00; 5.0  317.00  8.3255e-01 -8.9857e-03 2.0  1.2272e+00  3.5393e+00  1.6207e+00  6.9898e-01  1.0666e+00  1.0366e+00   5.0  317.00; 5.5  317.00  9.3328e-01 -9.4425e-02 2.0  1.7388e+00  5.6367e+00  1.5939e+00  8.2772e-01  1.0637e+00  1.0337e+00   5.5  317.00; 6.0  317.00  9.6786e-01 -1.0575e-01 2.0  2.0371e+00  4.4326e+00  1.5835e+00  9.3047e-01  1.0545e+00  1.0163e+00   6.0  317.00; 6.5  317.00  9.9191e-01 -1.2806e-01 2.0  2.2631e+00  4.7905e+00  1.5624e+00  9.7756e-01  1.0573e+00  1.0188e+00   6.5  317.00; 7.0  317.00  9.8463e-01 -1.2911e-01 2.0  2.4172e+00  4.1328e+00  1.5968e+00  1.0248e+00  1.0671e+00  1.0121e+00   7.0  317.00; 7.5  317.00  9.8211e-01 -1.4721e-01 2.0  1.4960e+00  2.3251e+00  2.0687e+00  8.3602e-01  1.0789e+00  9.7502e-01   7.5  317.00; 8.0  317.00  9.8036e-01 -1.3181e-01 2.0  1.4355e+00  2.1624e+00  2.0674e+00  8.5037e-01  1.0726e+00  9.6315e-01   8.0  317.00; 4.0  502.40  7.7145e-01 -2.1903e-08 2.0  7.5501e-01  1.2254e+00  1.9918e+00  4.8005e-01  1.0784e+00  1.0568e+00   4.0  502.40; 4.5  502.40  8.3924e-01 -1.7176e-02 2.0  8.4240e-01  1.7566e+00  1.7682e+00  5.8451e-01  1.0631e+00  1.0452e+00   4.5  502.40; 5.0  502.40  8.6317e-01 -3.0913e-02 2.0  1.2712e+00  3.3879e+00  1.4455e+00  7.1360e-01  1.0659e+00  1.0382e+00   5.0  502.40; 5.5  502.40  9.3729e-01 -1.1001e-01 2.0  1.9503e+00  6.6024e+00  1.4210e+00  8.4644e-01  1.0762e+00  1.0447e+00   5.5  502.40; 6.0  502.40  9.8756e-01 -1.2780e-01 2.0  2.3398e+00  5.8967e+00  1.4040e+00  9.5484e-01  1.0593e+00  1.0275e+00   6.0  502.40; 6.5  502.40  1.0255e+00 -1.6704e-01 2.0  2.7393e+00  5.7808e+00  1.5652e+00  1.0339e+00  1.0626e+00  1.0108e+00   6.5  502.40; 7.0  502.40  1.0233e+00 -1.6031e-01 2.0  2.9463e+00  4.5741e+00  1.5529e+00  1.0997e+00  1.0652e+00  1.0006e+00   7.0  502.40; 7.5  502.40  1.0200e+00 -1.2401e-01 2.0  3.0000e+00  3.9155e+00  1.6445e+00  1.1560e+00  1.0461e+00  9.6435e-01   7.5  502.40; 8.0  502.40  1.0002e+00 -1.1999e-01 2.0  2.5675e+00  3.3955e+00  1.6785e+00  1.1070e+00  1.0599e+00  9.6587e-01   8.0  502.40; 4.0  796.20  8.8270e-01 -8.3018e-02 2.0  1.2361e+00  3.2178e+00  1.2860e+00  6.5438e-01  1.0883e+00  1.0605e+00   4.0  796.20; 4.5  796.20  9.0131e-01 -9.0819e-02 2.0  1.4035e+00  3.7970e+00  1.3032e+00  7.1226e-01  1.0843e+00  1.0593e+00   4.5  796.20; 5.0  796.20  9.3558e-01 -8.3350e-02 2.0  1.5771e+00  4.0563e+00  1.2214e+00  7.8376e-01  1.0603e+00  1.0343e+00   5.0  796.20; 5.5  796.20  9.8071e-01 -1.2639e-01 2.0  2.1823e+00  5.4690e+00  1.2828e+00  8.9979e-01  1.0625e+00  1.0402e+00   5.5  796.20; 6.0  796.20  1.0292e+00 -1.6994e-01 2.0  2.9999e+00  6.5631e+00  1.2973e+00  1.0071e+00  1.0608e+00  1.0173e+00   6.0  796.20; 6.5  796.20  1.0716e+00 -2.0385e-01 2.0  3.0000e+00  6.0142e+00  1.4500e+00  1.0802e+00  1.0575e+00  1.0181e+00   6.5  796.20; 7.0  796.20  1.1170e+00 -2.2503e-01 2.0  3.0000e+00  5.5908e+00  1.6436e+00  1.1310e+00  1.0466e+00  1.0011e+00   7.0  796.20; 7.5  796.20  1.1243e+00 -2.3116e-01 2.0  3.0000e+00  4.7524e+00  1.7099e+00  1.1844e+00  1.0490e+00  9.9987e-01   7.5  796.20; 8.0  796.20  1.0006e+00 -1.1062e-01 2.0  2.8163e+00  3.0643e+00  1.6161e+00  1.2033e+00  1.0543e+00  9.8424e-01   8.0  796.20; 4.0 1262.00  1.1142e+00 -2.9561e-01 2.0  1.6692e+00  6.1510e+00  1.3141e+00  7.6115e-01  1.0829e+00  1.0502e+00   4.0 1262.00; 4.5 1262.00  1.1450e+00 -2.8700e-01 2.0  1.9553e+00  6.0141e+00  1.2838e+00  8.6221e-01  1.0634e+00  1.0392e+00   4.5 1262.00; 5.0 1262.00  1.1431e+00 -3.0083e-01 2.0  2.2941e+00  6.8268e+00  1.2609e+00  8.9057e-01  1.0726e+00  1.0475e+00   5.0 1262.00; 5.5 1262.00  1.1467e+00 -2.7310e-01 2.0  2.5178e+00  6.9746e+00  1.3125e+00  9.6257e-01  1.0554e+00  1.0372e+00   5.5 1262.00; 6.0 1262.00  1.1623e+00 -2.9893e-01 2.0  3.0000e+00  7.2278e+00  1.4351e+00  1.0457e+00  1.0629e+00  1.0252e+00   6.0 1262.00; 6.5 1262.00  1.2000e+00 -3.2059e-01 2.0  3.0000e+00  7.6028e+00  1.5529e+00  1.0983e+00  1.0535e+00  1.0295e+00   6.5 1262.00; 7.0 1262.00  1.2000e+00 -3.0723e-01 2.0  3.0000e+00  6.1282e+00  1.6668e+00  1.1508e+00  1.0466e+00  1.0024e+00   7.0 1262.00; 7.5 1262.00  1.2000e+00 -3.0499e-01 2.0  3.0000e+00  5.0982e+00  1.7273e+00  1.2181e+00  1.0481e+00  1.0067e+00   7.5 1262.00; 8.0 1262.00  1.2000e+00 -3.0348e-01 2.0  3.0000e+00  4.2696e+00  1.8291e+00  1.2610e+00  1.0492e+00  9.8681e-01   8.0 1262.00 ]

const coefs_ena_bt12 = [ 4.0    2.00  7.4499e-01 -3.0772e-02 2.0  1.3928e+00  8.3838e-01  2.4979e+00  6.7955e-01  1.0253e+00  9.6354e-01  4.0    2.00; 4.5    2.00  7.6659e-01 -3.0413e-02 2.0  1.3636e+00  9.7771e-01  2.3632e+00  6.9419e-01  1.0538e+00  9.6656e-01  4.5    2.00; 5.0    2.00  8.5088e-01 -2.7815e-06 2.0  1.2579e+00  9.8032e-01  2.0749e+00  7.8838e-01  1.0598e+00  9.5727e-01  5.0    2.00; 5.5    2.00  7.6469e-01 -1.0292e-07 2.0  1.1153e+00  8.5585e-01  2.1955e+00  6.0514e-01  1.0745e+00  9.7063e-01  5.5    2.00; 6.0    2.00  8.0539e-01 -4.1307e-17 2.0  1.0631e+00  8.3666e-01  2.1792e+00  6.3713e-01  1.0776e+00  9.5917e-01  6.0    2.00; 6.5    2.00  8.2454e-01 -1.1132e-16 2.0  1.0240e+00  7.5717e-01  2.1935e+00  6.4412e-01  1.0957e+00  9.4398e-01  6.5    2.00; 7.0    2.00  8.4196e-01 -8.3632e-03 2.0  9.8648e-01  7.3577e-01  2.2221e+00  6.4268e-01  1.1001e+00  9.1936e-01  7.0    2.00; 7.5    2.00  8.0918e-01 -1.9895e-06 2.0  9.1407e-01  7.9186e-01  2.2626e+00  5.7595e-01  1.1080e+00  9.0618e-01  7.5    2.00; 8.0    2.00  1.1574e+00 -4.1628e-01 2.0  7.1549e-01  3.3332e+00  4.1754e+00  4.0981e-01  1.1114e+00  8.7461e-01  8.0    2.00; 4.0    3.17  7.4249e-01 -3.4061e-02 2.0  1.3792e+00  8.1130e-01  2.5371e+00  6.6759e-01  1.0251e+00  9.6351e-01  4.0    3.17; 4.5    3.17  7.7349e-01 -2.2472e-02 2.0  1.3817e+00  9.9520e-01  2.3073e+00  7.2181e-01  1.0535e+00  9.6624e-01  4.5    3.17; 5.0    3.17  8.5089e-01 -4.4519e-07 2.0  1.2735e+00  9.9594e-01  2.0666e+00  7.9499e-01  1.0601e+00  9.5733e-01  5.0    3.17; 5.5    3.17  7.6277e-01 -3.8418e-08 2.0  1.1145e+00  8.4433e-01  2.2020e+00  6.0264e-01  1.0744e+00  9.7069e-01  5.5    3.17; 6.0    3.17  8.0431e-01 -1.3389e-17 2.0  1.0649e+00  8.3603e-01  2.1806e+00  6.3657e-01  1.0778e+00  9.5924e-01  6.0    3.17; 6.5    3.17  8.2327e-01 -9.8165e-21 2.0  1.0255e+00  7.5555e-01  2.1958e+00  6.4310e-01  1.0954e+00  9.4426e-01  6.5    3.17; 7.0    3.17  8.4445e-01 -1.2431e-02 2.0  9.8210e-01  7.3887e-01  2.2377e+00  6.3896e-01  1.1000e+00  9.1991e-01  7.0    3.17; 7.5    3.17  8.0631e-01 -4.7208e-07 2.0  9.0758e-01  7.6090e-01  2.2867e+00  5.6936e-01  1.1083e+00  9.0648e-01  7.5    3.17; 8.0    3.17  1.1238e+00 -3.3574e-01 2.0  7.3859e-01  2.2882e+00  3.4862e+00  4.8200e-01  1.1122e+00  8.7493e-01  8.0    3.17; 4.0    5.02  7.4005e-01 -3.5818e-02 2.0  1.3817e+00  8.0165e-01  2.5506e+00  6.6482e-01  1.0248e+00  9.6350e-01  4.0    5.02; 4.5    5.02  7.7668e-01 -1.8238e-02 2.0  1.3961e+00  1.0010e+00  2.2827e+00  7.3750e-01  1.0531e+00  9.6663e-01  4.5    5.02; 5.0    5.02  8.5014e-01 -3.3214e-07 2.0  1.2845e+00  1.0033e+00  2.0625e+00  7.9911e-01  1.0594e+00  9.5759e-01  5.0    5.02; 5.5    5.02  7.6180e-01 -2.1336e-17 2.0  1.1175e+00  8.4272e-01  2.2037e+00  6.0313e-01  1.0745e+00  9.7063e-01  5.5    5.02; 6.0    5.02  8.0269e-01 -2.0009e-17 2.0  1.0693e+00  8.3770e-01  2.1815e+00  6.3637e-01  1.0776e+00  9.5939e-01  6.0    5.02; 6.5    5.02  8.2171e-01 -3.0971e-31 2.0  1.0280e+00  7.5486e-01  2.1982e+00  6.4214e-01  1.0955e+00  9.4444e-01  6.5    5.02; 7.0    5.02  8.4613e-01 -1.5745e-02 2.0  9.8072e-01  7.4313e-01  2.2508e+00  6.3615e-01  1.0995e+00  9.1966e-01  7.0    5.02; 7.5    5.02  8.0493e-01 -6.6301e-08 2.0  9.0662e-01  7.5179e-01  2.2949e+00  5.6713e-01  1.1082e+00  9.0712e-01  7.5    5.02; 8.0    5.02  1.1064e+00 -3.1800e-01 2.0  7.4773e-01  2.1428e+00  3.4018e+00  4.8628e-01  1.1116e+00  8.7545e-01  8.0    5.02; 4.0    7.96  7.3601e-01 -3.8687e-02 2.0  1.3940e+00  7.9664e-01  2.5636e+00  6.6310e-01  1.0243e+00  9.6349e-01  4.0    7.96; 4.5    7.96  7.8586e-01 -7.4996e-03 2.0  1.4162e+00  1.0088e+00  2.2240e+00  7.7432e-01  1.0527e+00  9.6619e-01  4.5    7.96; 5.0    7.96  8.4919e-01 -2.4409e-07 2.0  1.2958e+00  1.0061e+00  2.0606e+00  8.0357e-01  1.0588e+00  9.5731e-01  5.0    7.96; 5.5    7.96  7.6152e-01 -1.7248e-17 2.0  1.1247e+00  8.4775e-01  2.2017e+00  6.0650e-01  1.0740e+00  9.7116e-01  5.5    7.96; 6.0    7.96  8.0101e-01 -5.6871e-34 2.0  1.0761e+00  8.4182e-01  2.1812e+00  6.3750e-01  1.0776e+00  9.5969e-01  6.0    7.96; 6.5    7.96  8.1921e-01 -6.4799e-35 2.0  1.0327e+00  7.5446e-01  2.2011e+00  6.4087e-01  1.0955e+00  9.4462e-01  6.5    7.96; 7.0    7.96  8.4706e-01 -2.0159e-02 2.0  9.7927e-01  7.4729e-01  2.2700e+00  6.3117e-01  1.0997e+00  9.1996e-01  7.0    7.96; 7.5    7.96  8.0254e-01 -1.0004e-19 2.0  9.0843e-01  7.4615e-01  2.3023e+00  5.6478e-01  1.1079e+00  9.0698e-01  7.5    7.96; 8.0    7.96  1.0991e+00 -3.1060e-01 2.0  7.5231e-01  2.0950e+00  3.3597e+00  4.8859e-01  1.1116e+00  8.7612e-01  8.0    7.96; 4.0   12.62  7.0000e-01 -2.4374e-01 2.0  1.7607e+00  6.9945e+00  2.9837e+00  4.0530e-01  1.0529e+00  1.0123e+00  4.0   12.62; 4.5   12.62  8.1100e-01 -5.4627e-02 2.0  1.3644e+00  2.1006e+00  1.9852e+00  6.6942e-01  1.0678e+00  1.0024e+00  4.5   12.62; 5.0   12.62  7.9093e-01 -9.1466e-03 2.0  1.4484e+00  1.7639e+00  1.8515e+00  7.2182e-01  1.0770e+00  9.8893e-01  5.0   12.62; 5.5   12.62  7.8662e-01 -6.4267e-07 2.0  1.1562e+00  1.0929e+00  1.9671e+00  6.4646e-01  1.0865e+00  9.8772e-01  5.5   12.62; 6.0   12.62  8.4063e-01 -3.7478e-07 2.0  1.1179e+00  8.6813e-01  1.9900e+00  7.1682e-01  1.0880e+00  9.6728e-01  6.0   12.62; 6.5   12.62  8.2699e-01 -9.6153e-08 2.0  1.0649e+00  9.0260e-01  2.0259e+00  6.5749e-01  1.0958e+00  9.5398e-01  6.5   12.62; 7.0   12.62  8.0730e-01 -1.0776e-06 2.0  9.7457e-01  7.1721e-01  2.2248e+00  5.9962e-01  1.1051e+00  9.3355e-01  7.0   12.62; 7.5   12.62  8.2952e-01 -1.1781e-02 2.0  9.4264e-01  9.2716e-01  2.2199e+00  6.0866e-01  1.1050e+00  9.2204e-01  7.5   12.62; 8.0   12.62  1.1075e+00 -3.2347e-01 2.0  7.9284e-01  2.4170e+00  3.4246e+00  4.9618e-01  1.1125e+00  8.8831e-01  8.0   12.62; 4.0   20.00  7.0972e-01 -1.5611e-01 2.0  1.0568e+00  1.5270e+01  3.4374e+00  3.3059e-01  1.0844e+00  1.0550e+00  4.0   20.00; 4.5   20.00  7.5373e-01 -3.5155e-02 2.0  1.0502e+00  3.2069e+00  2.1437e+00  5.0568e-01  1.0894e+00  1.0373e+00  4.5   20.00; 5.0   20.00  7.4294e-01 -4.4353e-03 2.0  9.7401e-01  1.3124e+00  2.0837e+00  5.1430e-01  1.0829e+00  1.0347e+00  5.0   20.00; 5.5   20.00  7.2999e-01 -2.9787e-07 2.0  1.0646e+00  8.7860e-01  2.0446e+00  5.2091e-01  1.0870e+00  1.0000e+00  5.5   20.00; 6.0   20.00  7.9094e-01 -2.4672e-17 2.0  1.0599e+00  9.0053e-01  1.9662e+00  5.9849e-01  1.0887e+00  9.8811e-01  6.0   20.00; 6.5   20.00  8.0349e-01 -4.4357e-07 2.0  1.1059e+00  1.1712e+00  1.9580e+00  6.2395e-01  1.0934e+00  9.6524e-01  6.5   20.00; 7.0   20.00  8.2080e-01 -6.2367e-05 2.0  1.1345e+00  1.2266e+00  1.9089e+00  6.6433e-01  1.1049e+00  9.4121e-01  7.0   20.00; 7.5   20.00  8.2713e-01 -1.6679e-02 2.0  9.7085e-01  9.6843e-01  2.1135e+00  5.9319e-01  1.1024e+00  9.1320e-01  7.5   20.00; 8.0   20.00  1.1435e+00 -3.3384e-01 2.0  8.6005e-01  2.9950e+00  3.0842e+00  5.6602e-01  1.1145e+00  8.9025e-01  8.0   20.00; 4.0   31.70  7.5523e-01 -6.1519e-02 2.0  7.0295e-01  1.6974e+01  2.7714e+00  3.5788e-01  1.0968e+00  1.0716e+00  4.0   31.70; 4.5   31.70  7.2579e-01 -7.4006e-02 2.0  8.4409e-01  7.7628e+00  2.6833e+00  3.5510e-01  1.0895e+00  1.0478e+00  4.5   31.70; 5.0   31.70  7.3171e-01 -1.8856e-02 2.0  9.7754e-01  2.6668e+00  2.1737e+00  4.6838e-01  1.0968e+00  1.0442e+00  5.0   31.70; 5.5   31.70  7.4865e-01 -4.8344e-07 2.0  9.7714e-01  1.1250e+00  2.1068e+00  5.1255e-01  1.0960e+00  1.0332e+00  5.5   31.70; 6.0   31.70  7.6646e-01 -3.0853e-07 2.0  1.0203e+00  9.3153e-01  2.0629e+00  5.4787e-01  1.0977e+00  1.0095e+00  6.0   31.70; 6.5   31.70  7.7282e-01 -7.6203e-07 2.0  9.9068e-01  9.3050e-01  2.0019e+00  5.4762e-01  1.1004e+00  9.9098e-01  6.5   31.70; 7.0   31.70  8.0833e-01 -2.0127e-03 2.0  9.9126e-01  1.1425e+00  1.9250e+00  6.0071e-01  1.1018e+00  9.7147e-01  7.0   31.70; 7.5   31.70  8.2974e-01 -1.7129e-02 2.0  9.6726e-01  1.0363e+00  2.0572e+00  5.9916e-01  1.1023e+00  9.2972e-01  7.5   31.70; 8.0   31.70  1.1337e+00 -3.4815e-01 2.0  8.2312e-01  2.8601e+00  3.2358e+00  5.1106e-01  1.1149e+00  8.9638e-01  8.0   31.70; 4.0   50.24  7.0000e-01 -3.3844e-03 2.0  6.2430e-01  2.7092e+01  2.1023e+00  3.3039e-01  1.1043e+00  1.0745e+00  4.0   50.24; 4.5   50.24  7.0000e-01 -1.0683e-03 2.0  7.0260e-01  9.4854e+00  2.2301e+00  3.6400e-01  1.0999e+00  1.0722e+00  4.5   50.24; 5.0   50.24  7.0000e-01 -1.8942e-02 2.0  7.8355e-01  4.0256e+00  2.4505e+00  3.7077e-01  1.0970e+00  1.0617e+00  5.0   50.24; 5.5   50.24  7.0000e-01 -1.6300e-02 2.0  8.8500e-01  1.9832e+00  2.3716e+00  4.0325e-01  1.0971e+00  1.0463e+00  5.5   50.24; 6.0   50.24  7.1272e-01 -1.4726e-07 2.0  8.9286e-01  8.1783e-01  2.3500e+00  4.3997e-01  1.0965e+00  1.0360e+00  6.0   50.24; 6.5   50.24  7.6839e-01 -6.4575e-08 2.0  1.0072e+00  9.1313e-01  1.9774e+00  5.3680e-01  1.1030e+00  9.9851e-01  6.5   50.24; 7.0   50.24  7.9821e-01 -2.1127e-05 2.0  9.9853e-01  1.0824e+00  1.8584e+00  5.8686e-01  1.0951e+00  9.8511e-01  7.0   50.24; 7.5   50.24  8.3695e-01 -3.1385e-02 2.0  9.8773e-01  1.0788e+00  2.0739e+00  5.9519e-01  1.0989e+00  9.3891e-01  7.5   50.24; 8.0   50.24  1.2000e+00 -4.0437e-01 2.0  8.5839e-01  4.1919e+00  3.1777e+00  5.4781e-01  1.1109e+00  9.0655e-01  8.0   50.24; 4.0   79.62  7.0000e-01 -8.0890e-18 2.0  5.5429e-01  3.4017e+01  2.0664e+00  3.1187e-01  1.1005e+00  1.0754e+00  4.0   79.62; 4.5   79.62  7.0000e-01 -1.3090e-07 2.0  6.3896e-01  1.3043e+01  2.1523e+00  3.4652e-01  1.1058e+00  1.0788e+00  4.5   79.62; 5.0   79.62  7.0000e-01 -1.2290e-02 2.0  7.3580e-01  6.5228e+00  2.3315e+00  3.6224e-01  1.1035e+00  1.0648e+00  5.0   79.62; 5.5   79.62  7.0000e-01 -5.1176e-03 2.0  8.5381e-01  2.3219e+00  2.3280e+00  4.0281e-01  1.0951e+00  1.0580e+00  5.5   79.62; 6.0   79.62  7.4394e-01 -7.1538e-03 2.0  8.5853e-01  1.0128e+00  2.3976e+00  4.6298e-01  1.0970e+00  1.0547e+00  6.0   79.62; 6.5   79.62  7.3383e-01 -7.5166e-06 2.0  9.1533e-01  7.6082e-01  2.2108e+00  4.7191e-01  1.1022e+00  1.0224e+00  6.5   79.62; 7.0   79.62  7.6594e-01 -1.1135e-05 2.0  1.0242e+00  1.0944e+00  1.8323e+00  5.4115e-01  1.1060e+00  9.8341e-01  7.0   79.62; 7.5   79.62  8.3184e-01 -3.7984e-02 2.0  1.0252e+00  1.1924e+00  1.9481e+00  5.9080e-01  1.1065e+00  9.5858e-01  7.5   79.62; 8.0   79.62  1.2000e+00 -4.2855e-01 2.0  8.2436e-01  4.5732e+00  3.5456e+00  5.0411e-01  1.1105e+00  9.2490e-01  8.0   79.62; 4.0  126.19  7.0000e-01 -9.3134e-03 2.0  6.5770e-01  2.4111e+01  2.0921e+00  3.4515e-01  1.0948e+00  1.0737e+00  4.0  126.19; 4.5  126.19  7.0000e-01 -6.4122e-03 2.0  7.0065e-01  1.1473e+01  2.2173e+00  3.6651e-01  1.0964e+00  1.0705e+00  4.5  126.19; 5.0  126.19  7.0000e-01 -3.8103e-02 2.0  8.1428e-01  5.6824e+00  2.5118e+00  3.6708e-01  1.0982e+00  1.0603e+00  5.0  126.19; 5.5  126.19  7.0000e-01 -2.0781e-02 2.0  8.8580e-01  2.2925e+00  2.3286e+00  4.0074e-01  1.0892e+00  1.0465e+00  5.5  126.19; 6.0  126.19  7.1685e-01 -2.3828e-03 2.0  9.4160e-01  1.1819e+00  2.1530e+00  4.6235e-01  1.0937e+00  1.0376e+00  6.0  126.19; 6.5  126.19  7.5639e-01 -6.9748e-06 2.0  1.0266e+00  1.0918e+00  1.9603e+00  5.4218e-01  1.0949e+00  1.0160e+00  6.5  126.19; 7.0  126.19  7.8490e-01 -1.8834e-05 2.0  1.1253e+00  1.1569e+00  1.8651e+00  6.0514e-01  1.0910e+00  9.7531e-01  7.0  126.19; 7.5  126.19  8.2386e-01 -3.8922e-02 2.0  1.0819e+00  1.3516e+00  1.9944e+00  5.9384e-01  1.0999e+00  9.5643e-01  7.5  126.19; 8.0  126.19  1.2000e+00 -4.3500e-01 2.0  8.3252e-01  3.9690e+00  3.5290e+00  4.9975e-01  1.1068e+00  9.2419e-01  8.0  126.19; 4.0  200.00  7.0000e-01 -9.9722e-09 2.0  5.7369e-01  2.2867e+01  2.0999e+00  3.2613e-01  1.0893e+00  1.0764e+00  4.0  200.00; 4.5  200.00  7.0000e-01 -2.0290e-15 2.0  6.9245e-01  1.1532e+01  2.0741e+00  3.6652e-01  1.0896e+00  1.0693e+00  4.5  200.00; 5.0  200.00  7.0000e-01 -1.7951e-02 2.0  7.5549e-01  5.9753e+00  2.4248e+00  3.6718e-01  1.0879e+00  1.0610e+00  5.0  200.00; 5.5  200.00  7.0000e-01 -1.2546e-02 2.0  8.5451e-01  2.9617e+00  2.2767e+00  4.0641e-01  1.0935e+00  1.0547e+00  5.5  200.00; 6.0  200.00  7.1629e-01 -4.5233e-07 2.0  9.3155e-01  1.7244e+00  2.1745e+00  4.5411e-01  1.0864e+00  1.0374e+00  6.0  200.00; 6.5  200.00  7.4775e-01 -1.1187e-05 2.0  1.0262e+00  1.3210e+00  1.9536e+00  5.2329e-01  1.0925e+00  1.0271e+00  6.5  200.00; 7.0  200.00  7.8534e-01 -5.3183e-05 2.0  1.0803e+00  1.3301e+00  1.8174e+00  6.0116e-01  1.0887e+00  1.0000e+00  7.0  200.00; 7.5  200.00  8.3010e-01 -4.3565e-02 2.0  1.0546e+00  1.3811e+00  1.9608e+00  5.9829e-01  1.1017e+00  9.7409e-01  7.5  200.00; 8.0  200.00  1.2000e+00 -4.2648e-01 2.0  8.5386e-01  4.6946e+00  3.5826e+00  5.2896e-01  1.0980e+00  9.4662e-01  8.0  200.00; 4.0  317.00  7.0000e-01 -3.0941e-07 2.0  5.4038e-01  2.0798e+01  2.1620e+00  3.1839e-01  1.0999e+00  1.0873e+00  4.0  317.00; 4.5  317.00  7.0000e-01 -2.0482e-02 2.0  6.1477e-01  1.5841e+01  2.4554e+00  3.1946e-01  1.0955e+00  1.0786e+00  4.5  317.00; 5.0  317.00  7.0000e-01 -3.9962e-02 2.0  7.0732e-01  8.4084e+00  2.7415e+00  3.3211e-01  1.0985e+00  1.0637e+00  5.0  317.00; 5.5  317.00  7.0390e-01 -7.4679e-03 2.0  7.6534e-01  3.2582e+00  2.3231e+00  3.8841e-01  1.0927e+00  1.0643e+00  5.5  317.00; 6.0  317.00  7.3097e-01 -3.7794e-04 2.0  8.8502e-01  2.1430e+00  2.1211e+00  4.6048e-01  1.0888e+00  1.0423e+00  6.0  317.00; 6.5  317.00  7.7222e-01 -4.3701e-03 2.0  1.0979e+00  2.0230e+00  1.8593e+00  5.6905e-01  1.0903e+00  1.0215e+00  6.5  317.00; 7.0  317.00  7.9944e-01 -2.1160e-03 2.0  1.1200e+00  1.6581e+00  1.8141e+00  6.2103e-01  1.0856e+00  1.0083e+00  7.0  317.00; 7.5  317.00  7.9780e-01 -2.1297e-06 2.0  1.2097e+00  1.5811e+00  1.7106e+00  6.5362e-01  1.0932e+00  9.8560e-01  7.5  317.00; 8.0  317.00  1.2000e+00 -4.1799e-01 2.0  9.6603e-01  5.5529e+00  3.0556e+00  5.6936e-01  1.1012e+00  9.5754e-01  8.0  317.00; 4.0  502.40  7.0000e-01 -1.7111e-02 2.0  4.6999e-01  1.8968e+01  2.8200e+00  2.6648e-01  1.0937e+00  1.0850e+00  4.0  502.40; 4.5  502.40  7.0000e-01 -2.6396e-02 2.0  5.1949e-01  1.6368e+01  2.8759e+00  2.7832e-01  1.0958e+00  1.0749e+00  4.5  502.40; 5.0  502.40  7.0000e-01 -2.1671e-02 2.0  6.1000e-01  8.6654e+00  2.6980e+00  3.1148e-01  1.0901e+00  1.0729e+00  5.0  502.40; 5.5  502.40  7.0002e-01 -7.1630e-03 2.0  6.9537e-01  4.5437e+00  2.4581e+00  3.5831e-01  1.0952e+00  1.0655e+00  5.5  502.40; 6.0  502.40  7.6134e-01 -6.3443e-06 2.0  8.9341e-01  3.7976e+00  1.9228e+00  5.0275e-01  1.0876e+00  1.0463e+00  6.0  502.40; 6.5  502.40  7.9007e-01 -2.5364e-03 2.0  1.0237e+00  2.5624e+00  1.7955e+00  5.8082e-01  1.0837e+00  1.0309e+00  6.5  502.40; 7.0  502.40  7.8695e-01 -2.0933e-03 2.0  1.1867e+00  2.1554e+00  1.6970e+00  6.3350e-01  1.0993e+00  1.0215e+00  7.0  502.40; 7.5  502.40  8.1809e-01 -4.3629e-03 2.0  1.4327e+00  2.5223e+00  1.5747e+00  7.2501e-01  1.0885e+00  9.9483e-01  7.5  502.40; 8.0  502.40  1.2000e+00 -3.9261e-01 2.0  1.1094e+00  5.2480e+00  2.8220e+00  6.5055e-01  1.0920e+00  9.6559e-01  8.0  502.40; 4.0  796.20  7.0000e-01 -2.3099e-02 2.0  4.5581e-01  1.7534e+01  3.1836e+00  2.5169e-01  1.0938e+00  1.0935e+00  4.0  796.20; 4.5  796.20  7.0000e-01 -3.7902e-02 2.0  4.8070e-01  1.8783e+01  3.4708e+00  2.4695e-01  1.0957e+00  1.0901e+00  4.5  796.20; 5.0  796.20  7.0000e-01 -8.6256e-03 2.0  5.4088e-01  8.8700e+00  2.5344e+00  3.0798e-01  1.0999e+00  1.0796e+00  5.0  796.20; 5.5  796.20  7.2574e-01 -6.1859e-07 2.0  6.3759e-01  6.1694e+00  2.2528e+00  3.8172e-01  1.0942e+00  1.0656e+00  5.5  796.20; 6.0  796.20  7.9007e-01 -1.1663e-07 2.0  8.9429e-01  5.2998e+00  1.8310e+00  5.4462e-01  1.0835e+00  1.0541e+00  6.0  796.20; 6.5  796.20  8.0321e-01 -5.4738e-06 2.0  1.0887e+00  4.4263e+00  1.6296e+00  6.2320e-01  1.0833e+00  1.0565e+00  6.5  796.20; 7.0  796.20  8.3257e-01 -1.9010e-02 2.0  1.3544e+00  3.6403e+00  1.5790e+00  7.0373e-01  1.0842e+00  1.0292e+00  7.0  796.20; 7.5  796.20  8.2613e-01 -6.7595e-03 2.0  1.5248e+00  2.8118e+00  1.5264e+00  7.6541e-01  1.0887e+00  1.0129e+00  7.5  796.20; 8.0  796.20  1.1507e+00 -3.2529e-01 2.0  1.4633e+00  5.9123e+00  2.1639e+00  7.6925e-01  1.0861e+00  9.8940e-01  8.0  796.20; 4.0 1262.00  7.0380e-01 -2.3859e-02 2.0  4.6750e-01  1.6009e+01  3.2471e+00  2.5732e-01  1.0983e+00  1.0854e+00  4.0 1262.00; 4.5 1262.00  7.2948e-01 -1.4944e-02 2.0  4.8377e-01  1.2697e+01  2.6412e+00  2.9720e-01  1.0910e+00  1.0799e+00  4.5 1262.00; 5.0 1262.00  7.1686e-01 -8.8205e-09 2.0  5.0825e-01  8.9544e+00  2.5879e+00  3.1741e-01  1.0940e+00  1.0730e+00  5.0 1262.00; 5.5 1262.00  7.5789e-01 -5.9107e-07 2.0  6.3038e-01  8.3660e+00  2.0527e+00  4.2616e-01  1.0955e+00  1.0773e+00  5.5 1262.00; 6.0 1262.00  7.8795e-01 -1.1888e-06 2.0  9.4374e-01  7.9155e+00  1.6171e+00  5.6637e-01  1.0922e+00  1.0692e+00  6.0 1262.00; 6.5 1262.00  8.3205e-01 -7.7356e-04 2.0  1.3982e+00  7.1069e+00  1.4151e+00  7.1961e-01  1.0743e+00  1.0470e+00  6.5 1262.00; 7.0 1262.00  8.2346e-01 -5.7461e-03 2.0  1.6840e+00  5.8126e+00  1.3549e+00  7.5587e-01  1.0847e+00  1.0338e+00  7.0 1262.00; 7.5 1262.00  8.4754e-01 -2.1169e-02 2.0  1.9081e+00  4.5097e+00  1.3691e+00  8.1498e-01  1.0837e+00  1.0215e+00  7.5 1262.00; 8.0 1262.00  8.5187e-01 -1.5704e-02 2.0  2.7561e+00  4.7263e+00  1.2542e+00  9.5985e-01  1.0839e+00  1.0185e+00  8.0 1262.00 ]



function boore_thompson_2012_coefs(idx_m::T, idx_r::T; region::Symbol=:WNA) where T<:Int
  idx = (idx_m - 1) * num_r_jj_bt12 + idx_r
  if region == :WNA
    @inbounds c = coefs_wna_bt12[idx,3:9]
    return c
  elseif region == :ENA
    @inbounds c = coefs_ena_bt12[idx,3:9]
    return c
  end
end


# base function for Boore & Thompson (2012)
function boore_thompson_2012_base(η::Float64, c::Vector{Float64}; ζ::Float64=0.05)
  @inbounds ratio = (c[1] + c[2]*((1.0 - η^c[3])/(1.0 + η^c[3]))) * (1.0 + c[4]/(2π*ζ)*( η /(1.0 + c[5]*η^c[6]) )^c[7])
  return ratio
end


# function to implement the Boore & Thompson (2012) duration ratio model
function boore_thompson_2012(m::T, r::T, fas::FourierParameters, sdof::Oscillator{T}; region::Symbol=:WNA) where T<:Float64
  # for magnitude and distance that don't match coefficient tables we need to use bilinear interpolation
  # get the excitation duration (as recommended by Boore & Thompson, 2012)
  Dex = boore_thompson_2014(m, r, fas)
  # get the oscillator period
  T_n = 1.0 / sdof.f_n
  # define the η parameter as T_n/Dex
  η = T_n / Dex

  # impose limits on the magnitudes and distances
  m = ( m < 4.0 ) ? 4.0 : m
  m = ( m > 8.0 ) ? 8.0 : m
  r = ( r < 2.0 ) ? 2.0 : r
  r = ( r > 1262.0 ) ? 1262.0 : r

  # get the bounding indicies
  i_lo = findlast( m_ii_bt12 .<= m )
  i_hi = findfirst( m_ii_bt12 .>= m )
  j_lo = findlast( r_jj_bt12 .<= r )
  j_hi = findfirst( r_jj_bt12 .>= r )

  # check for situations in which the coefficients are known for the given m,r
  if i_lo == i_hi # we have coefficients for this magnitude
    if j_lo == j_hi # we have coefficients for this distance
      c = boore_thompson_2012_coefs(i_lo, j_lo; region=region)
      Dratio = boore_thompson_2012_base(η, c)
    else # we need to interpolate the distance values only
      r_lo = r_jj_bt12[j_lo]
      r_hi = r_jj_bt12[j_hi]
      c_lo = boore_thompson_2012_coefs(i_lo, j_lo; region=region)
      c_hi = boore_thompson_2012_coefs(i_lo, j_hi; region=region)
      D_lo = boore_thompson_2012_base(η, c_lo)
      D_hi = boore_thompson_2012_base(η, c_hi)
      Dratio = D_lo + (r - r_lo)/(r_hi - r_lo)*(D_hi - D_lo)
    end
  else # we need to interpolate the magnitudes
    if j_lo == j_hi # we have coefficients for this distance
      m_lo = m_ii_bt12[i_lo]
      m_hi = m_ii_bt12[i_hi]
      c_lo = boore_thompson_2012_coefs(i_lo, j_lo; region=region)
      c_hi = boore_thompson_2012_coefs(i_hi, j_lo; region=region)
      D_lo = boore_thompson_2012_base(η, c_lo)
      D_hi = boore_thompson_2012_base(η, c_hi)
      Dratio = D_lo + (m - m_lo)/(m_hi - m_lo)*(D_hi - D_lo)
    else # we need to interpolate for this magnitude and distance
      # create the combinations of (m,r) from these indices
      m_lo = m_ii_bt12[i_lo]
      m_hi = m_ii_bt12[i_hi]
      r_lo = r_jj_bt12[j_lo]
      r_hi = r_jj_bt12[j_hi]

      # get the corresponding coefficients
      c_ll = boore_thompson_2012_coefs(i_lo, j_lo; region=region)
      c_lh = boore_thompson_2012_coefs(i_lo, j_hi; region=region)
      c_hl = boore_thompson_2012_coefs(i_hi, j_lo; region=region)
      c_hh = boore_thompson_2012_coefs(i_hi, j_hi; region=region)

      # get the corresponding ratios
      Dr_ll = boore_thompson_2012_base(η, c_ll)
      Dr_lh = boore_thompson_2012_base(η, c_lh)
      Dr_hl = boore_thompson_2012_base(η, c_hl)
      Dr_hh = boore_thompson_2012_base(η, c_hh)

      # bilinear interpolation
      D = [ Dr_ll Dr_lh; Dr_hl Dr_hh ]
      knots = ([m_lo, m_hi], [r_lo, r_hi])
      # create interpolant
      itp_D = interpolate(knots, D, Gridded(Linear()))
      Dratio = itp_D(m,r)
    end
  end
  Drms = Dratio * Dex
  return (Drms, Dex, Dratio)
end
